<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@include file="../includes/header.jsp"%>
<head>
<link rel="stylesheet" type="text/css"
	href="../../../resources/css/list.css" />
<link rel="stylesheet" type="text/css"
	href="../../../resources/css/common.css" />
<link rel="stylesheet" type="text/css"
	href="../../../resources/css/register.css" />
<style>
td.table-light {
	width: 12%;
	vertical-align: middle;
	text-align: center;
}

input[type="checkbox"] {
	width: 15px;
	height: 15px;
}

label {
    float: left;
}
select.input_width20 {
    float: left;
    font-size: 0.9rem;
    padding: 5px 3px;
    width: -webkit-fill-available;
    border-radius: 4px;
    border-color: ghostwhite;
}
    
</style>
</head>
<div class="right-container">
	<h1>
		<b>신규 취약점 등록 </b>
	</h1>
	<hr>
	<table class="table table-bordered">
		<tr>
			<td class="table-light" colspan="2">취약점명</td>
			<td colspan="6"><input type="text" name=""
				class="input_width100" placeholder="취약점명 입력"></td>
		</tr>
		<tr>
			<td class="table-light" colspan="2">제조사</td>
			<td colspan="6"><input type="text" class="input_width100"
				name="" placeholder="제조사 입력"></td>
		</tr>
		<tr>
			<td class="table-light" colspan="2">모델</td>
			<td colspan="2"><input type="text" class="input_width100"
				name="" placeholder="모델입력"></td>
			<td class="table-light" colspan="2">시스템S/W유형</td>
			<td colspan="2"><select class="input_width100">
					<option value="부서1">Windows</option>
					<option value="부서2">UNIX</option>
					<option value="부서3">Linux</option>
					<option value="부서3">Firmware</option>
			</select></td>
		</tr>
		<tr>
			<td class="table-light" colspan="2">획득일자</td>
			<td colspan="2"><input type='date' name='date'
				class="input_width100"></td>
			<td class="table-light" colspan="2">획득경로</td>
			<td colspan="2"><select class="input_width100">
					<option value="부서1">자체</option>
					<option value="부서2">KISA</option>
					<option value="부서3">산업부 사이버안전센터</option>
			</select></td>
		</tr>

		<tr>
			<td class="table-light" colspan="2">취약점 내용</td>
			<td colspan="6"><input type="text" class="input_width100"
				name="" placeholder="취약점 내용 입력"></td>
		</tr>
		<tr>
			<td class="table-light" colspan="2">조치방법</td>
			<td colspan="6"><textarea class="input_width100" rows="10"
					placeholder="조치 내용 입력"></textarea></td>
		</tr>
		<tr>
			<td class="table-light" colspan="2" rowspan="3">관련 통제항목</td>
			<td colspan="6">
			<label>통제항목 분류</label><br>
				<select class="input_width20" name="ci-select">
					<option value="table1">기술적</option>
					<option value="table2">운영적</option>
					<option value="table3">관리적</option>
					<option value="table4">Baseline 보호기준</option>
			</select></td>
		</tr>
		<tr>
			<td colspan="6">
				<table class="table table-hover" id="table1">
					<thead>
						<tr>

							<th scope="col">분야번호</th>
							<th scope="col">통제항복분류</th>
							<th scope="col">상세분류번호</th>
							<th scope="col">상세분류</th>
							<th scope="col">항목내용</th>
						</tr>
					</thead>
					<tbody>
						<tr>

							<td>1</td>
							<td>기술적</td>
							<td>1.1</td>
							<td>접근통제</td>
							<td>필수디지털자산 계정 관리(승인, 사용, 변경, 불응 및 삭제 절차) 및 문서화를 하고 있는가?</td>
						</tr>
						<tr>

							<td>1</td>
							<td>기술적</td>
							<td>1.2</td>
							<td>감사 및 책임</td>
							<td>검토절차의 수립 및 이에 따른 필수디지털자산 계정의 불법적인 사용 및 변경 여부에 대해 주기적 검토를
								하고 있는가?(최소 분기 1회)</td>

						</tr>
						<tr>
							<td>1</td>
							<td>기술적</td>
							<td>1.3</td>
							<td>시스템 및 통신의 보호</td>
							<td>주어진 업무를 수행하는데 필요한 만큼의 제한된 접근권한을 각 계정에 부여하고 있는가?</td>
						</tr>
						<tr>
							<td>1</td>
							<td>기술적</td>
							<td>1.4</td>
							<td>식별 및 인증</td>
							<td>업무의 변경 시 계정에 대한 접근권한을 검토를 통해 업무에 기반한 제한된 접근권한이 부여되고 있음을
								보장하고 있는가?</td>
						</tr>
						<tr>
							<td>1</td>
							<td>기술적</td>
							<td>1.5</td>
							<td>시스템 보안 강화</td>
							<td>다음과 같은 자동화된 계정관리 수행하여야 하며, 자동화된 계정관리가 불가할 경우 수기로 계정관리
								수행하고 있는가?</td>
						</tr>

					</tbody>
				</table>
				<table class="table table-hover" id="table2">
					<thead>
						<tr>

							<th scope="col">분야번호</th>
							<th scope="col">통제항복분류</th>
							<th scope="col">상세분류번호</th>
							<th scope="col">상세분류</th>
							<th scope="col">항목내용</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>2</td>
							<td>운영적</td>
							<td>2.1</td>
							<td>인적보안</td>
							<td>수립된 접근통제 저책 및 절차에 따라 필수디지털자산에 대한 접근통제 이행하고 있는가?</td>
						</tr>
						<tr>
							<td>2</td>
							<td>운영적</td>
							<td>2.2</td>
							<td>시스템 및 정보 무결성</td>
							<td>필수디지털자산별로 접근 및 사용가능한 사용자를 정의하고, 각 사용자별 접근권한 및 사용특권을
								차등부여하고 있는가?</td>
						</tr>
						<tr>
							<td>2</td>
							<td>운영적</td>
							<td>2.1</td>
							<td>인적보안</td>
							<td>수립된 접근통제 저책 및 절차에 따라 필수디지털자산에 대한 접근통제 이행하고 있는가?</td>
						</tr>
						<tr>
							<td>2</td>
							<td>운영적</td>
							<td>2.2</td>
							<td>시스템 및 정보 무결성</td>
							<td>필수디지털자산별로 접근 및 사용가능한 사용자를 정의하고, 각 사용자별 접근권한 및 사용특권을
								차등부여하고 있는가?</td>
						</tr>
						<tr>
							<td>2</td>
							<td>운영적</td>
							<td>2.1</td>
							<td>인적보안</td>
							<td>수립된 접근통제 저책 및 절차에 따라 필수디지털자산에 대한 접근통제 이행하고 있는가?</td>
						</tr>
						<tr>
							<td>2</td>
							<td>운영적</td>
							<td>2.2</td>
							<td>시스템 및 정보 무결성</td>
							<td>필수디지털자산별로 접근 및 사용가능한 사용자를 정의하고, 각 사용자별 접근권한 및 사용특권을
								차등부여하고 있는가?</td>
						</tr>
					</tbody>
				</table>
				<table class="table table-hover" id="table3">
					<thead>
						<tr>

							<th scope="col">분야번호</th>
							<th scope="col">통제항복분류</th>
							<th scope="col">상세분류번호</th>
							<th scope="col">상세분류</th>
							<th scope="col">항목내용</th>
						</tr>
					</thead>
					<tbody>

						<tr>
							<td>3</td>
							<td>관리적</td>
							<td>3.1</td>
							<td>시스템 및 서비스 획득</td>
							<td>필수디지터라산이 자동적으로 감사대상 로그를 생성하지 못하는 경우에는 정당한 사유를 문서화하고 대안적인
								보안조치를 이행하고 있는가?</td>
						</tr>
						<tr>
							<td>3</td>
							<td>관리적</td>
							<td>3.1</td>
							<td>시스템 및 서비스 획득</td>
							<td>필수디지터라산이 자동적으로 감사대상 로그를 생성하지 못하는 경우에는 정당한 사유를 문서화하고 대안적인
								보안조치를 이행하고 있는가?</td>
						</tr>

					</tbody>
				</table>
				<table class="table table-hover" id="table4">
					<thead>
						<tr>

							<th scope="col">분야번호</th>
							<th scope="col">통제항복분류</th>
							<th scope="col">상세분류번호</th>
							<th scope="col">상세분류</th>
							<th scope="col">항목내용</th>
						</tr>
					</thead>
					<tbody>

						<tr>
							<td>4</td>
							<td>관리적</td>
							<td>4.1</td>
							<td>시스템 및 서비스 획득</td>
							<td>필수디지터라산이 자동적으로 감사대상 로그를 생성하지 못하는 경우에는 정당한 사유를 문서화하고 대안적인
								보안조치를 이행하고 있는가?</td>
						</tr>
						<tr>
							<td>4</td>
							<td>관리적</td>
							<td>4.1</td>
							<td>시스템 및 서비스 획득</td>
							<td>필수디지터라산이 자동적으로 감사대상 로그를 생성하지 못하는 경우에는 정당한 사유를 문서화하고 대안적인
								보안조치를 이행하고 있는가?</td>
						</tr>
						<tr>
							<td>4</td>
							<td>관리적</td>
							<td>4.1</td>
							<td>시스템 및 서비스 획득</td>
							<td>필수디지터라산이 자동적으로 감사대상 로그를 생성하지 못하는 경우에는 정당한 사유를 문서화하고 대안적인
								보안조치를 이행하고 있는가?</td>
						</tr>
						<tr>
							<td>4</td>
							<td>관리적</td>
							<td>4.1</td>
							<td>시스템 및 서비스 획득</td>
							<td>필수디지터라산이 자동적으로 감사대상 로그를 생성하지 못하는 경우에는 정당한 사유를 문서화하고 대안적인
								보안조치를 이행하고 있는가?</td>
						</tr>
					</tbody>
				</table>
			</td>
		</tr>
		<tr>
			<td colspan="6"><label>선택된 통제항목</label><br>
			<td>
		</tr>
	</table>
	<div class="table_button_group">
		<button type="button" class="btn btn-danger" data-toggle="modal"
			data-target="#staticBackdrop" onclick="alertRegister()">등록</button>
	</div>
</div>
<script>
	$(document).ready(function() {
		$(table2).hide();
		$(table3).hide();
		$(table4).hide();
	});

	$("select[name=ci-select]").change(function() {
		//alert($(this).val());//value값 가져오기
		if ($(this).val().toString() == "table1") {
			$(table1).show();
			$(table2).hide();
			$(table3).hide();
			$(table4).hide();
		} else if ($(this).val().toString() == "table2") {
			$(table1).hide();
			$(table2).show();
			$(table3).hide();
			$(table4).hide();
		} else if ($(this).val().toString() == "table3") {
			$(table1).hide();
			$(table2).hide();
			$(table3).show();
			$(table4).hide();
		} else if ($(this).val().toString() == "table4") {
			$(table1).hide();
			$(table2).hide();
			$(table3).hide();
			$(table4).show();
		}
		//console.log($("select[name=location] option:selected").text()); //text값 가져오기
	});

	function select(val) {
		var target = document.getElementsByClassName("modal_items");
		target[val].style.backgroundColor = "rgb(146 171 198 / 25%)";
		//if(val)
	}

	function alertRegister() {
		if (confirm("신규 취약점을 등록하시겠습니까?") == true) {
			alert("등록되었습니다");
			location.href = "new_vulnerability_detail.html";
		} else {
			return;
		}
	}
</script>
<%@include file="../includes/footer.jsp"%>